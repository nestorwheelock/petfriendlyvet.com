{% extends "base_portal.html" %}
{% load i18n %}

{% block title %}{% trans "Emergency Hospitals" %}{% endblock %}

{% block portal_content %}
<div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <div class="flex items-center justify-between mb-8">
        <div>
            <h1 class="text-3xl font-bold text-gray-900">{% trans "Emergency Hospitals" %}</h1>
            <p class="text-gray-600 mt-1">{% trans "Find 24-hour veterinary care near you" %}</p>
        </div>
        <a href="{% url 'emergency:home' %}" class="text-primary-600 hover:text-primary-700 font-medium">
            ‚Üê {% trans "Back" %}
        </a>
    </div>

    <!-- Filter -->
    <div class="bg-white rounded-xl shadow p-4 mb-6">
        <div class="flex items-center gap-4">
            <label class="flex items-center gap-2 cursor-pointer">
                <input type="checkbox"
                       onchange="window.location.href='?24hours=' + (this.checked ? '1' : '')"
                       {% if filter_24hours %}checked{% endif %}
                       class="rounded border-gray-300 text-primary-600 focus:ring-primary-500">
                <span class="text-sm font-medium text-gray-700">{% trans "Show 24-hour only" %}</span>
            </label>
        </div>
    </div>

    <!-- Hospital List -->
    {% if hospitals %}
    <div class="space-y-4">
        {% for hospital in hospitals %}
        <div class="bg-white rounded-xl shadow overflow-hidden">
            <div class="p-6">
                <div class="flex items-start justify-between">
                    <div class="flex-1">
                        <div class="flex items-center gap-2">
                            <h2 class="text-lg font-bold text-gray-900">{{ hospital.name }}</h2>
                            {% if hospital.is_24_hours %}
                            <span class="px-2 py-0.5 bg-green-100 text-green-700 rounded text-xs font-medium">
                                {% trans "24 Hours" %}
                            </span>
                            {% endif %}
                        </div>
                        <p class="text-gray-500 mt-1">{{ hospital.address }}</p>

                        <!-- Services -->
                        {% if hospital.services %}
                        <div class="mt-3 flex flex-wrap gap-1">
                            {% for service in hospital.services %}
                            <span class="px-2 py-0.5 bg-blue-50 text-blue-600 rounded text-xs">
                                {{ service }}
                            </span>
                            {% endfor %}
                        </div>
                        {% endif %}

                        <!-- Species Treated -->
                        {% if hospital.species_treated %}
                        <p class="text-sm text-gray-500 mt-2">
                            <strong>{% trans "Species:" %}</strong>
                            {{ hospital.species_treated|join:", " }}
                        </p>
                        {% endif %}
                    </div>

                    <!-- Contact Buttons -->
                    <div class="flex flex-col gap-2 ml-4">
                        <a href="tel:{{ hospital.phone }}" class="bg-green-600 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-green-700 transition text-center">
                            üìû {% trans "Call" %}
                        </a>
                        {% if hospital.whatsapp %}
                        <a href="https://wa.me/{{ hospital.whatsapp }}" target="_blank" class="bg-green-500 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-green-600 transition text-center">
                            üí¨ WhatsApp
                        </a>
                        {% endif %}
                        <a href="https://maps.google.com/?q={{ hospital.latitude }},{{ hospital.longitude }}" target="_blank" class="bg-blue-600 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-blue-700 transition text-center">
                            üó∫Ô∏è {% trans "Map" %}
                        </a>
                    </div>
                </div>

                {% if hospital.distance_km %}
                <div class="mt-3 text-sm text-gray-500">
                    üìç {{ hospital.distance_km }} km {% trans "away" %}
                </div>
                {% endif %}

                {% if hospital.notes %}
                <div class="mt-3 text-sm text-gray-500">
                    {{ hospital.notes }}
                </div>
                {% endif %}
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <div class="bg-gray-50 rounded-xl p-8 text-center">
        <span class="text-4xl block mb-4">üè•</span>
        <p class="text-gray-500">{% trans "No emergency hospitals found." %}</p>
    </div>
    {% endif %}
</div>
{% endblock portal_content %}
